import{d as te,u as ae,r as p,c as x,w as le,b as m,e as oe,f as a,g as se,i as e,m as l,l as V,t as d,n as r,q as ne}from"./index-B8j9Fg8x.js";import{i as ie}from"./items-R1paJi57.js";import{a as de,c as re}from"./booking-M7MEwy1G.js";import{l as ue}from"./lodash-kvVwPKOQ.js";import{n as _}from"./rules-6ndjMkCM.js";import{g as ce,a as me}from"./roomtype-E1NtJmk8.js";import"./index-_h905p1k.js";import"./axios-QLjAsgXu.js";const pe={class:"responsive-datatable"},_e=["data-label"],ve=["data-label"],fe=["data-label"],be=["data-label"],ye=["data-label"],ge=["data-label"],ke=["data-label"],he=["data-label"],xe=["data-label"],Ve={class:"text-body-2 text-grey"},we={class:"text-body-2 text-grey"},Ue={class:"text-body-2 text-grey"},Ce={class:"text-body-2 text-grey"},je={class:"text-body-2 text-grey"},De={class:"text-body-2 text-grey"},ze={class:"text-body-2 text-grey"},$e={class:"text-body-2 text-grey"},Se={class:"text-body-2 text-grey"},Te={class:"text-body-2 text-grey"},Be={class:"text-body-2 text-grey"},Ie={class:"text-body-2 text-grey"},Ne={class:"text-body-2 text-grey"},Fe=te({__name:"Reversation",setup(Pe){const{t:i}=ae(),H=[{title:"booking.client",key:"client",sortable:!0},{title:"rooms.room_no",key:"room",sortable:!1},{title:"rooms.room_type",key:"room_type",sortable:!1},{title:"booking.email",key:"email",sortable:!1},{title:"booking.check_in",key:"check_in",sortable:!1},{title:"booking.check_out",key:"check_out",sortable:!1},{title:"booking.total_amount",key:"total_price",sortable:!1}],n=p({room:null,room_type:null,check_in:null,check_out:null,total_price:0,client:"",phone:"",email:"",address:""}),b=p(!1),w=p(!1),y=p(1),f=p(25),g=p(0),k=p(""),U=p(null),L=x(()=>{const o=new URLSearchParams;return y.value&&o.append("page",y.value),f.value&&o.append("perpage",f.value),k.value.trim()&&o.append("search",k.value),o.toString()}),M=x(()=>{const o=(y.value-1)*f.value;return`${o+1}-${o+h.value.length} / ${g.value}`}),O=ue.debounce(o=>{k.value=o,y.value=1},500),A=x(()=>H.map(o=>({...o,title:i(o.title)}))),C=x(()=>{const o=new Date(n.value.check_in),s=new Date(n.value.check_out);if(o&&s){const c=s.getTime()-o.getTime(),u=c/(1e3*3600*24);return c<=0?0:u}else return 0}),h=p([]),z=p([]),$=p([]),F=async()=>{const{data:o}=await ce();o.status==="ok"&&(z.value=o.types)},G=async()=>{const{valid:o}=await U.value.validate();o&&K()},J=async o=>{if(!(o!=null&&o.id))return;const{data:s}=await me(o.id);s.status==="ok"&&($.value=s.result)},S=async()=>{w.value=!0;const{data:o}=await de(L.value);o.status==="ok"&&(h.value=o.result,g.value=o.totalCount),w.value=!1},K=async()=>{n.value.total_price=C.value*n.value.room.price,n.value.room_type_id=n.value.room_type.id,n.value.room_id=n.value.room.id;const{data:o}=await re(n.value);o.status==="ok"&&(h.value.push(o.result),T())},T=()=>{b.value=!1,ne(()=>{var o;n.value=Object.assign({},{room:null,room_type:null,check_in:null,check_out:null,total_price:0,client:"",phone:"",email:"",address:""}),(o=U.value)==null||o.reset()})};return F(),le(b,o=>o||T()),(o,s)=>{const c=m("v-text-field"),u=m("v-col"),B=m("v-icon"),j=m("v-btn"),I=m("v-card-title"),Q=m("v-data-table-server"),N=m("v-card-text"),P=m("v-card"),D=m("v-select"),W=m("v-pagination"),R=m("v-row"),q=m("v-divider"),X=m("v-form"),Y=m("v-dialog"),Z=m("v-container");return se(),oe(Z,{fluid:""},{default:a(()=>[e(R,{align:"center",justify:"space-between"},{default:a(()=>[e(u,{cols:"9",sm:"6",md:"4",class:"pb-0 pr-0"},{default:a(()=>[e(c,{"onUpdate:modelValue":l(O),placeholder:l(i)("search"),"append-inner-icon":"mdi-magnify",flat:"","hide-details":"",density:"compact",variant:"solo"},null,8,["onUpdate:modelValue","placeholder"])]),_:1}),e(u,{cols:"3",sm:"4",md:"2",class:"pb-0 d-flex justify-end"},{default:a(()=>[e(j,{flat:"",onClick:s[0]||(s[0]=t=>b.value=!b.value),color:"primary",size:"43",width:"100%"},{default:a(()=>[e(B,null,{default:a(()=>[V("mdi-plus")]),_:1})]),_:1})]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(P,{flat:""},{default:a(()=>[e(I,{class:"px-4 pt-3"},{default:a(()=>[V(d(l(i)("booking.title")),1)]),_:1}),e(N,{class:"px-0"},{default:a(()=>[r("div",pe,[e(Q,{"items-per-page":f.value,"onUpdate:itemsPerPage":s[1]||(s[1]=t=>f.value=t),search:k.value,"items-length":g.value,loading:w.value,"no-data-text":l(i)("nodata"),"loading-text":l(i)("load_data"),"onUpdate:options":S,items:h.value,headers:A.value,density:"comfortable"},{bottom:a(()=>[]),"item.client":a(({item:t})=>[r("td",{"data-label":l(i)("booking.client")},d(t.client),9,_e)]),"item.room":a(({item:t})=>{var v;return[r("td",{"data-label":l(i)("rooms.room_no")},d((v=t.raw.room)==null?void 0:v.name),9,ve)]}),"item.phone":a(({item:t})=>[r("td",{"data-label":l(i)("booking.phone")},d(t.raw.phone),9,fe)]),"item.email":a(({item:t})=>[r("td",{"data-label":l(i)("booking.email")},d(t.raw.email),9,be)]),"item.address":a(({item:t})=>[r("td",{"data-label":l(i)("booking.address")},d(t.raw.address),9,ye)]),"item.total_price":a(({item:t})=>[r("td",{"data-label":l(i)("booking.total_amount")},d(t.raw.total_price),9,ge)]),"item.room_type":a(({item:t})=>{var v;return[r("td",{"data-label":l(i)("rooms.room_type")},d((v=t.raw.room_type)==null?void 0:v.name),9,ke)]}),"item.check_in":a(({item:t})=>[r("td",{"data-label":l(i)("booking.check_in")},d(t.raw.check_in),9,he)]),"item.check_out":a(({item:t})=>[r("td",{"data-label":l(i)("booking.check_out")},d(t.raw.check_out),9,xe)]),_:1},8,["items-per-page","search","items-length","loading","no-data-text","loading-text","items","headers"])])]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",sm:"4",class:"pt-0 pb-1 d-flex align-center"},{default:a(()=>[e(D,{modelValue:f.value,"onUpdate:modelValue":s[2]||(s[2]=t=>f.value=t),transition:"fade-transition","hide-details":"",flat:"",density:"compact",variant:"solo",items:l(ie)},null,8,["modelValue","items"]),e(c,{class:"ml-3","hide-details":"",flat:"",density:"compact",variant:"solo","model-value":M.value,readonly:""},null,8,["model-value"])]),_:1}),e(u,{cols:"12",sm:"4",md:"4",class:"pt-0 pl-0 pb-1 pr-2 d-flex justify-end align-center"},{default:a(()=>[e(W,{modelValue:y.value,"onUpdate:modelValue":[s[3]||(s[3]=t=>y.value=t),S],length:Math.ceil(g.value/f.value),size:"40","total-visible":"3",variant:"flat","active-color":"primary"},null,8,["modelValue","length"])]),_:1})]),_:1}),e(Y,{transition:"fade-transition",modelValue:b.value,"onUpdate:modelValue":s[15]||(s[15]=t=>b.value=t),"max-width":"600"},{default:a(()=>[e(P,null,{default:a(()=>[e(I,{class:"px-4 d-flex justify-space-between align-center"},{default:a(()=>[r("span",null,d(l(i)("booking.create_booking")),1),e(j,{onClick:s[4]||(s[4]=t=>b.value=!1),flat:"",size:"30",color:"primary"},{default:a(()=>[e(B,{size:"small"},{default:a(()=>[V("mdi-close")]),_:1})]),_:1})]),_:1}),e(N,{class:"px-4 py-3"},{default:a(()=>[e(X,{ref_key:"form",ref:U},{default:a(()=>[e(R,null,{default:a(()=>[e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Ve,d(l(i)("rooms.room_type")),1),e(D,{rules:l(_),items:z.value,modelValue:n.value.room_type,"onUpdate:modelValue":[s[5]||(s[5]=t=>n.value.room_type=t),J],"return-object":"","item-title":"name",transition:"fade-transition",class:"mt-1","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["rules","items","modelValue"])]),_:1}),e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",we,d(l(i)("rooms.room_no")),1),e(D,{modelValue:n.value.room,"onUpdate:modelValue":s[6]||(s[6]=t=>n.value.room=t),items:$.value,"item-title":"name","return-object":"",rules:l(_),transition:"fade-transition",class:"mt-1","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["modelValue","items","rules"])]),_:1}),e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Ue,d(l(i)("booking.check_in_date")),1),e(c,{modelValue:n.value.check_in,"onUpdate:modelValue":s[7]||(s[7]=t=>n.value.check_in=t),rules:l(_),class:"mt-1",type:"date","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Ce,d(l(i)("booking.check_in_date")),1),e(c,{modelValue:n.value.check_out,"onUpdate:modelValue":s[8]||(s[8]=t=>n.value.check_out=t),rules:l(_),class:"mt-1",type:"date","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12",class:"pb-0"},{default:a(()=>[e(q)]),_:1}),e(u,{cols:"4",sm:"4",class:"pb-0 pr-0"},{default:a(()=>[r("span",je,d(l(i)("booking.total_days")),1),e(c,{"model-value":C.value,class:"mt-1",readonly:"","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["model-value"])]),_:1}),e(u,{cols:"8",sm:"4",class:"pb-0"},{default:a(()=>{var t,v;return[r("span",De,d(l(i)("booking.rent")),1),e(c,{type:"number",min:"1",disabled:!((t=n.value.room)!=null&&t.price),"onUpdate:modelValue":s[9]||(s[9]=ee=>{var E;((E=n.value.room)==null?void 0:E.price)!==void 0&&(n.value.room.price=ee)}),"model-value":((v=n.value.room)==null?void 0:v.price)||0,rules:l(_),class:"mt-1","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["disabled","model-value","rules"])]}),_:1}),e(u,{cols:"12",sm:"4",class:"pb-0"},{default:a(()=>{var t;return[r("span",ze,d(l(i)("booking.total_amount")),1),e(c,{onInput:s[10]||(s[10]=v=>n.value.total_price=v.target.value),"model-value":C.value*(((t=n.value.room)==null?void 0:t.price)||0),type:"number",class:"mt-1",readonly:"","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["model-value"])]}),_:1}),e(u,{cols:"12",class:"pb-0"},{default:a(()=>[e(q)]),_:1}),e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",$e,d(l(i)("booking.client")),1),e(c,{modelValue:n.value.client,"onUpdate:modelValue":s[11]||(s[11]=t=>n.value.client=t),rules:l(_),class:"mt-1","hide-details":"",density:"compact",placeholder:"",flat:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Se,d(l(i)("booking.phone")),1),e(c,{modelValue:n.value.phone,"onUpdate:modelValue":s[12]||(s[12]=t=>n.value.phone=t),rules:l(_),class:"mt-1",type:"text","hide-details":"",density:"compact",placeholder:"998 00 000 00 00",flat:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Te,d(l(i)("booking.email")),1),e(c,{modelValue:n.value.email,"onUpdate:modelValue":s[13]||(s[13]=t=>n.value.email=t),rules:l(_),class:"mt-1","hide-details":"",density:"compact",placeholder:"example@mail.com",flat:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Be,d(l(i)("booking.address")),1),e(c,{modelValue:n.value.address,"onUpdate:modelValue":s[14]||(s[14]=t=>n.value.address=t),rules:l(_),class:"mt-1",type:"text","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"4",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Ie,d(l(i)("booking.card_exp")),1),e(c,{rules:l(_),class:"mt-1","hide-details":"",density:"compact",placeholder:"00/00",flat:"",variant:"outlined"},null,8,["rules"])]),_:1}),e(u,{cols:"8",sm:"6",class:"pb-0"},{default:a(()=>[r("span",Ne,d(l(i)("booking.card_num")),1),e(c,{rules:l(_),class:"mt-1","hide-details":"",density:"compact",placeholder:"0000 0000 0000 0000",flat:"",variant:"outlined"},null,8,["rules"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(j,{height:"40",class:"mt-1",color:"primary",block:"",flat:"",onClick:G},{default:a(()=>[V(d(l(i)("save")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{Fe as default};
