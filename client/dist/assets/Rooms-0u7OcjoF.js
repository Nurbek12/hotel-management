import{d as _e,u as fe,r,c as q,w as ye,b as d,e as be,f as e,g as N,i as t,m as s,z as ge,l as c,t as u,n as i,j as G,k as xe,F as ke,q as he}from"./index-B8j9Fg8x.js";import{n as R}from"./rules-6ndjMkCM.js";import{i as Ve}from"./items-R1paJi57.js";import{g as we,u as Ce,c as ze,b as je,e as Ue,f as $e,h as Ie,i as Te}from"./roomtype-E1NtJmk8.js";import{l as Be}from"./lodash-kvVwPKOQ.js";import"./index-_h905p1k.js";import"./axios-QLjAsgXu.js";const Oe={class:"responsive-datatable"},Ee=["data-label"],Pe=i("span",null,null,-1),Se=["data-label"],qe=["data-label"],Ne=["data-label"],Re=["data-label"],Fe={class:"text-body-2 text-grey"},Le={class:"text-left text-caption"},De={class:"text-right text-caption"},He={class:"text-body-2"},Me={class:"d-flex align-center justify-end"},Ae={class:"text-body-2 text-grey"},Ge={class:"text-body-2 text-grey"},Je={class:"text-body-2 text-grey"},at=_e({__name:"Rooms",setup(Ke){const J=[{title:"rooms.room_no",key:"name",sortable:!0},{title:"rooms.room_type",key:"type",sortable:!1},{title:"price",key:"price",sortable:!0},{title:"rooms.booking",key:"booked",sortable:!1},{title:"actions",key:"actions",sortable:!1,align:"end"}],{t:n,locale:K}=fe(),z=r(!1),b=r(!1),$=r(null),g=r([]),x=r([]),k=r({name:""}),w=r(null),m=r({name:"",type:null,price:0}),C=r(null),I=r(!1),V=r(1),y=r(25),j=r(0),U=r(""),Q=q(()=>{const a=new URLSearchParams;return V.value&&a.append("page",V.value),y.value&&a.append("perpage",y.value),U.value.trim()&&a.append("search",U.value),a.toString()}),W=q(()=>{const a=(V.value-1)*y.value;return`${a+1}-${a+g.value.length} / ${j.value}`}),X=Be.debounce(a=>{U.value=a,V.value=1},500),Y=q(()=>J.map(a=>({...a,title:n(a.title)}))),Z=async()=>{const{data:a}=await we();a.status==="ok"&&(x.value=a.types)},ee=async()=>{if(w.value){const{data:a}=await Ce(w.value,k.value);if(a.status!=="ok")return;const o=x.value.findIndex(v=>v.id===w.value);Object.assign(x.value[o],a.result)}else{const{data:a}=await ze(k.value);if(a.status!=="ok")return;x.value.push(a.result)}T(!1)},te=async(a,o)=>{confirm(n("delete_confirm_text"))&&(await Te(o),x.value.splice(a,1))},ae=a=>{w.value=a.id,k.value=Object.assign({},a)},T=a=>{a&&(z.value=!1),w.value=null,k.value=Object.assign({},{name:""})},le=async()=>{const{valid:a}=await $.value.validate();a&&oe()},F=async()=>{I.value=!0;const{data:a}=await je(Q.value);a.status==="ok"&&(g.value=a.result,j.value=a.totalCount),I.value=!1},oe=async()=>{if(C.value){m.value.type_id=m.value.type.id;const{data:a}=await Ue(C.value,m.value);if(a.status!=="ok")return;const o=g.value.findIndex(v=>v.id===C.value);Object.assign(g.value[o],a.result)}else{const{data:a}=await $e(m.value);if(a.status!=="ok")return;g.value.push(a.result)}L()},se=a=>{C.value=a.id,m.value=Object.assign({},a),b.value=!0},ne=async(a,o)=>{confirm("Ushbu malumotni o'chirmoqchimisiz?")&&(await Ie(o),g.value.splice(a,1))},L=()=>{b.value=!1,he(()=>{var a;m.value=Object.assign({},{name:"",type:null,price:0}),C.value=null,(a=$.value)==null||a.reset()})};return Z(),ye(b,a=>a||L()),(a,o)=>{const v=d("v-text-field"),p=d("v-col"),_=d("v-icon"),f=d("v-btn"),D=d("v-list-item-title"),H=d("v-list-item"),ie=d("v-list"),de=d("v-menu"),B=d("v-card-title"),ue=d("v-chip"),ce=d("v-data-table-server"),O=d("v-card-text"),E=d("v-card"),M=d("v-select"),re=d("v-pagination"),P=d("v-row"),me=d("v-table"),A=d("v-dialog"),pe=d("v-form"),ve=d("v-container");return N(),be(ve,{fluid:""},{default:e(()=>[t(P,{justify:"space-between",align:"center"},{default:e(()=>[t(p,{cols:"9",sm:"6",md:"4",class:"pb-0 pr-0"},{default:e(()=>[t(v,{"onUpdate:modelValue":s(X),placeholder:s(n)("search"),"append-inner-icon":"mdi-magnify","hide-details":"",flat:"",density:"compact",variant:"solo"},null,8,["onUpdate:modelValue","placeholder"])]),_:1}),t(p,{cols:"3",sm:"4",md:"2",class:"pb-0 d-flex justify-end"},{default:e(()=>[t(de,{transition:"fade-transition"},{activator:e(({props:l})=>[t(f,ge(l,{flat:"",color:"primary",size:"43",width:"100%"}),{default:e(()=>[t(_,null,{default:e(()=>[c("mdi-plus")]),_:1})]),_:2},1040)]),default:e(()=>[t(ie,{elevation:"2",density:"compact"},{default:e(()=>[t(H,{link:"",onClick:o[0]||(o[0]=l=>b.value=!0)},{prepend:e(()=>[t(_,{style:{"margin-inline-end":"16px !important"}},{default:e(()=>[c("mdi-package")]),_:1})]),default:e(()=>[t(D,{class:"text-caption"},{default:e(()=>[c(u(s(n)("rooms.add_room")),1)]),_:1})]),_:1}),t(H,{link:"",onClick:o[1]||(o[1]=l=>z.value=!0)},{prepend:e(()=>[t(_,{style:{"margin-inline-end":"16px !important"}},{default:e(()=>[c("mdi-view-list")]),_:1})]),default:e(()=>[t(D,{class:"text-caption"},{default:e(()=>[c(u(s(n)("rooms.add_room_type")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(p,{cols:"12"},{default:e(()=>[t(E,{flat:""},{default:e(()=>[t(B,{class:"px-4 pt-3"},{default:e(()=>[c(u(s(n)("rooms.title")),1)]),_:1}),t(O,{class:"px-0"},{default:e(()=>[i("div",Oe,[t(ce,{"items-per-page":y.value,"onUpdate:itemsPerPage":o[2]||(o[2]=l=>y.value=l),search:U.value,"items-length":j.value,loading:I.value,"no-data-text":s(n)("nodata"),"loading-text":s(n)("load_data"),"onUpdate:options":F,items:g.value,"item-value":"id",headers:Y.value,density:"comfortable"},{bottom:e(()=>[]),"item.actions":e(({item:l,index:h})=>[i("td",{"data-label":s(n)("actions"),class:"d-flex justify-space-between align-center"},[Pe,i("div",null,[t(f,{onClick:S=>se(l),color:"light-blue-accent-4",size:"30",flat:"",class:"mr-1"},{default:e(()=>[t(_,null,{default:e(()=>[c("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(f,{onClick:S=>ne(h,l.id),color:"light-blue-accent-4",size:"30",flat:""},{default:e(()=>[t(_,null,{default:e(()=>[c("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])],8,Ee)]),"item.booked":e(({item:l})=>[i("td",{"data-label":s(n)("rooms.booking")},[t(ue,{label:"",color:l.booked?"red-accent-3":"green-accent-3",variant:"flat"},{default:e(()=>[c(u((l.booked?{en:"Booked",ru:"Бронировано",uz:"Egallangan"}:{en:"Empty",ru:"Пустой",uz:"Bo'sh"})[s(K)]),1)]),_:2},1032,["color"])],8,Se)]),"item.name":e(({item:l})=>[i("td",{"data-label":s(n)("rooms.room_no")},u(l.name),9,qe)]),"item.type":e(({item:l})=>{var h;return[i("td",{"data-label":s(n)("rooms.room_type")},u((h=l.type)==null?void 0:h.name),9,Ne)]}),"item.price":e(({item:l})=>[i("td",{"data-label":s(n)("price")},u(l.price),9,Re)]),_:1},8,["items-per-page","search","items-length","loading","no-data-text","loading-text","items","headers"])])]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",sm:"4",class:"pt-0 pb-1 d-flex align-center"},{default:e(()=>[t(M,{modelValue:y.value,"onUpdate:modelValue":o[3]||(o[3]=l=>y.value=l),transition:"fade-transition","hide-details":"",flat:"",density:"compact",variant:"solo",items:s(Ve)},null,8,["modelValue","items"]),t(v,{class:"ml-3","hide-details":"",flat:"",density:"compact",variant:"solo","model-value":W.value,readonly:""},null,8,["model-value"])]),_:1}),t(p,{cols:"12",sm:"4",md:"4",class:"pt-0 pl-0 pb-1 pr-2 d-flex justify-end align-center"},{default:e(()=>[t(re,{modelValue:V.value,"onUpdate:modelValue":[o[4]||(o[4]=l=>V.value=l),F],length:Math.ceil(j.value/y.value),"active-color":"primary",size:"40","total-visible":"3",variant:"flat"},null,8,["modelValue","length"])]),_:1})]),_:1}),t(A,{modelValue:z.value,"onUpdate:modelValue":o[8]||(o[8]=l=>z.value=l),width:"500",transition:"fade-transition"},{default:e(()=>[t(E,{elevation:"1"},{default:e(()=>[t(B,{class:"px-5 d-flex justify-space-between align-center"},{default:e(()=>[i("span",null,u(s(n)("rooms.room_type")),1),t(f,{flat:"",onClick:o[5]||(o[5]=l=>T(!0)),size:"32",color:"primary"},{default:e(()=>[t(_,{size:"small"},{default:e(()=>[c("mdi-close")]),_:1})]),_:1})]),_:1}),t(O,{class:"px-5 py-4"},{default:e(()=>[t(P,null,{default:e(()=>[t(p,{cols:"12",class:"pb-0 pt-0"},{default:e(()=>[i("span",Fe,u(s(n)("rooms.room_type")),1),t(v,{"onClick:clear":o[6]||(o[6]=l=>T(!1)),modelValue:k.value.name,"onUpdate:modelValue":o[7]||(o[7]=l=>k.value.name=l),clearable:"","clear-icon":"mdi-close",class:"mt-1","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12"},{default:e(()=>{var l;return[t(f,{onClick:ee,disabled:!((l=k.value.name)!=null&&l.trim()),height:"40",class:"mt-1",color:"primary",block:"",flat:""},{default:e(()=>[c(u(s(n)("save")),1)]),_:1},8,["disabled"])]}),_:1}),t(p,{cols:"12",class:"pt-0"},{default:e(()=>[t(me,{height:"100%",density:"comfortable"},{default:e(()=>[i("thead",null,[i("tr",null,[i("th",Le,u(s(n)("rooms.room_type")),1),i("th",De,u(s(n)("actions")),1)])]),i("tbody",null,[(N(!0),G(ke,null,xe(x.value,(l,h)=>(N(),G("tr",{key:h},[i("td",He,u(l.name),1),i("td",Me,[t(f,{size:"30",variant:"flat",color:"primary",onClick:S=>ae(l)},{default:e(()=>[t(_,{size:"18"},{default:e(()=>[c("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(f,{size:"30",variant:"flat",color:"primary",class:"ml-1"},{default:e(()=>[t(_,{size:"18",onClick:S=>te(h,l.id)},{default:e(()=>[c("mdi-delete")]),_:2},1032,["onClick"])]),_:2},1024)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(A,{modelValue:b.value,"onUpdate:modelValue":o[13]||(o[13]=l=>b.value=l),width:"500",transition:"fade-transition"},{default:e(()=>[t(E,{elevation:"1"},{default:e(()=>[t(B,{class:"px-5 d-flex justify-space-between align-center"},{default:e(()=>[i("span",null,u(s(n)("rooms.title")),1),t(f,{flat:"",onClick:o[9]||(o[9]=l=>b.value=!1),size:"32",color:"primary"},{default:e(()=>[t(_,{size:"small"},{default:e(()=>[c("mdi-close")]),_:1})]),_:1})]),_:1}),t(O,{class:"px-5 py-4"},{default:e(()=>[t(pe,{class:"w-100",ref_key:"form",ref:$},{default:e(()=>[t(P,null,{default:e(()=>[t(p,{cols:"12",class:"pb-0 pt-0"},{default:e(()=>[i("span",Ae,u(s(n)("rooms.room_no")),1),t(v,{rules:s(R),modelValue:m.value.name,"onUpdate:modelValue":o[10]||(o[10]=l=>m.value.name=l),class:"mt-1","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["rules","modelValue"])]),_:1}),t(p,{cols:"12",class:"pb-0"},{default:e(()=>[i("span",Ge,u(s(n)("rooms.room_type")),1),t(M,{items:x.value,rules:s(R),"item-title":"name","item-value":"id",modelValue:m.value.type,"onUpdate:modelValue":o[11]||(o[11]=l=>m.value.type=l),transition:"fade-transition",class:"mt-1","hide-details":"",density:"compact",flat:"",variant:"outlined"},null,8,["items","rules","modelValue"])]),_:1}),t(p,{cols:"12",class:"pb-0"},{default:e(()=>[i("span",Je,u(s(n)("price")),1),t(v,{rules:s(R),modelValue:m.value.price,"onUpdate:modelValue":o[12]||(o[12]=l=>m.value.price=l),class:"mt-1",type:"number",min:"0","hide-details":"",density:"compact",placeholder:"0.00 $",flat:"",variant:"outlined"},null,8,["rules","modelValue"])]),_:1}),t(p,{cols:"12"},{default:e(()=>[t(f,{height:"40",class:"mt-1",color:"primary",block:"",flat:"",onClick:le},{default:e(()=>[c(u(s(n)("save")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{at as default};
